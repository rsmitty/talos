


<!DOCTYPE html>
<html lang="en-us">

<head>
  













<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">




<link rel="canonical" href="https://talos.dev/docs/latest/guides/storage/">



<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://talos.dev/img/logos/longhorn-icon-color.png">
<meta name="twitter:image:alt" content="Talos Linux color logo">



<meta property="og:url" content="https://talos.dev/docs/v0.14/guides/storage/">
<meta property="og:title" content="Talos Linux | Storage">

<meta property="og:type" content="article">
<meta property="og:site_name" content="Talos Linux">
<meta property="og:image" content="https://talos.dev/img/logos/longhorn-icon-color.png">
<meta property="og:image:type" content="image/png">
<meta property="og:image:alt" content="Talos Linux color logo">
<meta property="og:locale" content="en_US">


<meta name="robots" content="noindex">



  <title>
    
Talos Linux | Documentation

  </title>

  









<link rel="stylesheet" href="/css/style.d4f1ecd1424891e50994bf3612432659314faa7af1abc56b06aca280b90673fb.css" integrity="sha256-1PHs0UJIkeUJlL82EkMmWTFPqnrxq8VrBqyigLkGc/s=">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />

  <link rel="shortcut icon" type="image/png" sizes="32x32" href="/favicon.png">

</head>
<body>
  





<div class="canvas" id="canvas" x-data="{ drawer: false }">
  







<nav class="navbar is-fixed-top has-shadow" x-data="{ open: false }">
  
    <div class="navbar-brand">
      <a class="navbar-item" href="https://talos.dev">
        <img src="/img/logos/Sidero_horizontal_lightbkgd_RGB.png" alt="Talos Linux navbar logo">
      </a>

      <a role="button" class="navbar-burger" data-target="menu" aria-label="menu" aria-expanded="false" :class="{ 'is-active': open }" @click="open = !open" @click.away="open = false">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>

    <div class="navbar-menu" id="menu" :class="{ 'is-active': open }">
      <div class="navbar-end">
        <div class="navbar-item is-hidden-touch">
  <p class="control has-icons-left">
    <input class="input is-rounded" type="text" placeholder="Search" id="search-input">
    <span class="icon is-small is-left">
      <ion-icon name="search-outline"></ion-icon>
    </span>
  </p>
</div>


        


<nav class="navbar" role="navigation" aria-label="dropdown navigation">
  <div class="navbar-item has-dropdown is-hoverable">
    <a class="navbar-link is-arrowless" href="/docs/v1.0">
      <span class="has-text-weight-bold">
        Docs
      </span>
      <span class="icon has-text-secondary">
        <ion-icon name="chevron-down-outline"></ion-icon>
      </span>
    </a>

    <div class="navbar-dropdown">
      
      
      
      <a class="navbar-item" href="/docs/v1.0">
        v1.0 (<strong>latest</strong>)
      </a>
      
      
      
      <a class="navbar-item" href="/docs/v0.14">
        v0.14
      </a>
      
      
      
      <a class="navbar-item" href="/docs/v0.13">
        v0.13
      </a>
      
      
      
      <a class="navbar-item" href="/docs/v0.12">
        v0.12
      </a>
      
      
      
      <a class="navbar-item" href="/docs/v0.11">
        v0.11
      </a>
      
      
      
      <a class="navbar-item" href="/docs/v0.10">
        v0.10
      </a>
      
      
      
      <a class="navbar-item" href="/docs/v0.9">
        v0.9
      </a>
      
      
      
      <a class="navbar-item" href="/docs/v0.8">
        v0.8
      </a>
      
      
      
      <a class="navbar-item" href="/docs/v0.7">
        v0.7
      </a>
      
      
      
      <a class="navbar-item" href="/docs/v0.6">
        v0.6
      </a>
      
    </div>
  </div>
</nav>


        
        




<a class="navbar-item has-text-weight-bold" href="https://sidero.dev"  target="_blank" >
  <span>
    Sidero Metal
  </span>
</a>





<a class="navbar-item has-text-weight-bold" href="https://github.com/talos-systems/talos"  target="_blank" >
  <span>
    GitHub
  </span>
</a>





<a class="navbar-item has-text-weight-bold" href="https://taloscommunity.slack.com"  target="_blank" >
  <span>
    Slack
  </span>
</a>



        

        <div class="navbar-item">
          



<div class="buttons is-left">
  

  

  
</div>

        </div>
      </div>
    </div>
  
</nav>

  

<nav class="navbar is-black is-hidden-desktop under-nav">
  <div class="navbar-brand">
    <div class="navbar-item is-hidden-desktop">
      <a class="button is-black is-borderless has-text-weight-light" @click="drawer = !drawer">
        <span class="icon">
          <ion-icon name="list"></ion-icon>
        </span>
        <span>
          Docs
        </span>
      </a>
    </div>
  </div>
</nav>


  <div class="dashboard">
    
    <div class="dashboard-panel sidebar is-hidden-touch">
      


<aside class="nav is-sidebar">
  

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
   
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.14/">
      Welcome
    </a>

    
  </div>

  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.14/introduction/">
      Introduction
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/introduction/what-is-talos/">
          What is Talos?
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/introduction/quickstart/">
          Quickstart
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/introduction/getting-started/">
          Getting Started
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/introduction/system-requirements/">
          System Requirements
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/introduction/what-is-new/">
          What&#39;s New in Talos 0.14
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/introduction/support-matrix/">
          Support Matrix
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.14/bare-metal-platforms/">
      Bare Metal Platforms
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/bare-metal-platforms/digital-rebar/">
          Digital Rebar
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/bare-metal-platforms/equinix-metal/">
          Equinix Metal
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/bare-metal-platforms/matchbox/">
          Matchbox
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/bare-metal-platforms/sidero/">
          Sidero
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.14/virtualized-platforms/">
      Virtualized Platforms
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/virtualized-platforms/hyper-v/">
          Hyper-V
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/virtualized-platforms/kvm/">
          KVM
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/virtualized-platforms/proxmox/">
          Proxmox
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/virtualized-platforms/vmware/">
          VMware
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/virtualized-platforms/xen/">
          Xen
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.14/cloud-platforms/">
      Cloud Platforms
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/cloud-platforms/aws/">
          AWS
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/cloud-platforms/azure/">
          Azure
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/cloud-platforms/digitalocean/">
          DigitalOcean
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/cloud-platforms/gcp/">
          GCP
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/cloud-platforms/hetzner/">
          Hetzner
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/cloud-platforms/nocloud/">
          Nocloud
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/cloud-platforms/openstack/">
          Openstack
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/cloud-platforms/scaleway/">
          Scaleway
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/cloud-platforms/upcloud/">
          UpCloud
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/cloud-platforms/vultr/">
          Vultr
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.14/local-platforms/">
      Local Platforms
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/local-platforms/docker/">
          Docker
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/local-platforms/qemu/">
          QEMU
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/local-platforms/virtualbox/">
          VirtualBox
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.14/single-board-computers/">
      Single Board Computers
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/single-board-computers/bananapi_m64/">
          Banana Pi M64
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/single-board-computers/libretech_all_h3_cc_h5/">
          Libre Computer Board ALL-H3-CC
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/single-board-computers/pine64/">
          Pine64
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/single-board-computers/rock64/">
          Pine64 Rock64
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/single-board-computers/rockpi_4/">
          Radxa ROCK PI 4c
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/single-board-computers/rpi_4/">
          Raspberry Pi 4 Model B
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.14/guides/">
      Guides
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/adding-a-proprietary-kernel-module/">
          Adding a proprietary kernel module to Talos Linux
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/advanced-networking/">
          Advanced Networking
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/air-gapped/">
          Air-gapped Environments
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/configuring-certificate-authorities/">
          Configuring Certificate Authorities
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/configuring-containerd/">
          Configuring Containerd
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/configuring-corporate-proxies/">
          Configuring Corporate Proxies
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/configuring-network-connectivity/">
          Configuring Network Connectivity
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/configuring-pull-through-cache/">
          Configuring Pull Through Cache
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/configuring-the-cluster-endpoint/">
          Configuring the Cluster Endpoint
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/configuring-wireguard-network/">
          Configuring Wireguard Network
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/customizing-the-kernel/">
          Customizing the Kernel
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/customizing-the-root-filesystem/">
          Customizing the Root Filesystem
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/deploying-cilium/">
          Deploying Cilium CNI
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/deploy-metrics-server/">
          Deploying Metrics Server
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/disaster-recovery/">
          Disaster Recovery
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/discovery/">
          Discovery
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/disk-encryption/">
          Disk Encryption
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/editing-machine-configuration/">
          Editing Machine Configuration
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/kubespan/">
          KubeSpan
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/logging/">
          Logging
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/managing-pki/">
          Managing PKI
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/resetting-a-machine/">
          Resetting a Machine
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/rbac/">
          Role-based access control (RBAC)
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a class="is-active" href="/docs/v0.14/guides/storage/">
          Storage
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/troubleshooting-control-plane/">
          Troubleshooting Control Plane
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/upgrading-kubernetes/">
          Upgrading Kubernetes
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/upgrading-talos/">
          Upgrading Talos
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/vip/">
          Virtual (shared) IP
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.14/reference/">
      Reference
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/reference/kernel/">
          Kernel
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/reference/platform/">
          Platform
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.14/learn-more/">
      Learn More
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/learn-more/philosophy/">
          Philosophy
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/learn-more/concepts/">
          Concepts
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/learn-more/architecture/">
          Architecture
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/learn-more/components/">
          Components
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/learn-more/upgrades/">
          Upgrades
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/learn-more/faqs/">
          FAQs
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/learn-more/talosctl/">
          talosctl
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/learn-more/control-plane/">
          Control Plane
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/learn-more/controllers-resources/">
          Controllers and Resources
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/learn-more/networking-resources/">
          Networking Resources
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/learn-more/discovery/">
          Discovery
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/learn-more/kubespan/">
          KubeSpan
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/learn-more/developing-talos/">
          Developing Talos
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
</aside>

    </div>

    <div class="dashboard-panel main">
      



<section class="hero is-primary is-medium is-bold">
  <div class="hero-body">
    <div class="container">
      <div class="docs-content">
        <p class="title is-size-2 is-size-3-mobile has-text-weight-bold">
          Storage
        </p>

        
      </div>
      <div class="buttons">
        <a class="button is-small" href="https://github.com/longhorn/website/edit/master/content/docs/v0.14/Guides/storage.md" target="_blank">
          <span class="icon">
            <ion-icon name="logo-github"></ion-icon>
          </span>
          <span>
            Edit this page
          </span>
        </a>
      </div>
    </div>
  </div>
</section>

      
<section class="section">
  <div class="container">
    <div class="docs-content">
      <div class="content has-extra-bottom-padding">
        <p>In Kubernetes, using storage in the right way is well-facilitated by the API.<br>
However, unless you are running in a major public cloud, that API may not be hooked up to anything.
This frequently sends users down a rabbit hole of researching all the various options for storage backends for their platform, for Kubernetes, and for their workloads.
There are a <em>lot</em> of options out there, and it can be fairly bewildering.</p>
<p>For Talos, we try to limit the options somewhat to make the decision-making easier.</p>
<h2 id="public-cloud">Public Cloud</h2>
<p>If you are running on a major public cloud, use their block storage.
It is easy and automatic.</p>
<h2 id="storage-clusters">Storage Clusters</h2>
<blockquote>
<p><strong>Talos</strong> recommends having a separate disks (apart from the Talos install disk) to be used for storage.</p>
</blockquote>
<p>Redundancy in storage is usually very important.
Scaling capabilities, reliability, speed, maintenance load, and ease of use are all factors you must consider when managing your own storage.</p>
<p>Running a storage cluster can be a very good choice when managing your own storage, and there are two project we recommend, depending on your situation.</p>
<p>If you need vast amounts of storage composed of more than a dozen or so disks, just use Rook to manage Ceph.
Also, if you need <em>both</em> mount-once <em>and</em> mount-many capabilities, Ceph is your answer.
Ceph also bundles in an S3-compatible object store.
The down side of Ceph is that there are a lot of moving parts.</p>
<blockquote>
<p>Please note that <em>most</em> people should <em>never</em> use mount-many semantics.
NFS is pervasive because it is old and easy, <em>not</em> because it is a good idea.
While it may seem like a convenience at first, there are all manner of locking, performance, change control, and reliability concerns inherent in <em>any</em> mount-many situation, so we <strong>strongly</strong> recommend you avoid this method.</p>
</blockquote>
<p>If your storage needs are small enough to not need Ceph, use Mayastor.</p>
<h3 id="rookceph">Rook/Ceph</h3>
<p><a href="https://ceph.io">Ceph</a> is the grandfather of open source storage clusters.
It is big, has a lot of pieces, and will do just about anything.
It scales better than almost any other system out there, open source or proprietary, being able to easily add and remove storage over time with no downtime, safely and easily.
It comes bundled with RadosGW, an S3-compatible object store.
It comes with CephFS, a NFS-like clustered filesystem.
And of course, it comes with RBD, a block storage system.</p>
<p>With the help of <a href="https://rook.io">Rook</a>, the vast majority of the complexity of Ceph is hidden away by a very robust operator, allowing you to control almost everything about your Ceph cluster from fairly simple Kubernetes CRDs.</p>
<p>So if Ceph is so great, why not use it for everything?</p>
<p>Ceph can be rather slow for small clusters.
It relies heavily on CPUs and massive parallelisation to provide good cluster performance, so if you don&rsquo;t have much of those dedicated to Ceph, it is not going to be well-optimized for you.
Also, if your cluster is small, just running Ceph may eat up a significant amount of the resources you have available.</p>
<p>Troubleshooting Ceph can be difficult if you do not understand its architecture.
There are lots of acronyms and the documentation assumes a fair level of knowledge.
There are very good tools for inspection and debugging, but this is still frequently seen as a concern.</p>
<h3 id="mayastor">Mayastor</h3>
<p><a href="https://github.com/openebs/Mayastor">Mayastor</a> is an OpenEBS project built in Rust utilizing the modern NVMEoF system.
(Despite the name, Mayastor does <em>not</em> require you to have NVME drives.)
It is fast and lean but still cluster-oriented and cloud native.
Unlike most of the other OpenEBS project, it is <em>not</em> built on the ancient iSCSI system.</p>
<p>Unlike Ceph, Mayastor is <em>just</em> a block store.
It focuses on block storage and does it well.
It is much less complicated to set up than Ceph, but you probably wouldn&rsquo;t want to use it for more than a few dozen disks.</p>
<p>Mayastor is new, maybe <em>too</em> new.
If you&rsquo;re looking for something well-tested and battle-hardened, this is not it.
If you&rsquo;re looking for something lean, future-oriented, and simpler than Ceph, it might be a great choice.</p>
<h3 id="video-walkthrough">Video Walkthrough</h3>
<p>To see a live demo of this section, see the video below:</p>
<!-- raw HTML omitted -->
<h3 id="prep-nodes">Prep Nodes</h3>
<p>Either during initial cluster creation or on running worker nodes, several machine config values should be edited.
This information is gathered from the Mayastor <a href="https://mayastor.gitbook.io/introduction/quickstart/preparing-the-cluster">documentation</a>.
We need to set the <code>vm.nr_hugepages</code> sysctl and add <code>openebs.io/engine=mayastor</code> labels to the nodes which are meant to be storage nodes
This can be done with <code>talosctl patch machineconfig</code> or via config patches during <code>talosctl gen config</code>.</p>
<p>Some examples are shown below, modify as needed.</p>
<p>Using gen config</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>talosctl gen config my-cluster https://mycluster.local:6443 --config-patch <span style="color:#2aa198">&#39;[{&#34;op&#34;: &#34;add&#34;, &#34;path&#34;: &#34;/machine/sysctls&#34;, &#34;value&#34;: {&#34;vm.nr_hugepages&#34;: &#34;1024&#34;}}, {&#34;op&#34;: &#34;add&#34;, &#34;path&#34;: &#34;/machine/kubelet/extraArgs&#34;, &#34;value&#34;: {&#34;node-labels&#34;: &#34;openebs.io/engine=mayastor&#34;}}]&#39;</span>
</span></span></code></pre></div><p>Patching an existing node</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>talosctl patch --immediate machineconfig -n &lt;node ip&gt; --patch <span style="color:#2aa198">&#39;[{&#34;op&#34;: &#34;add&#34;, &#34;path&#34;: &#34;/machine/sysctls&#34;, &#34;value&#34;: {&#34;vm.nr_hugepages&#34;: &#34;1024&#34;}}, {&#34;op&#34;: &#34;add&#34;, &#34;path&#34;: &#34;/machine/kubelet/extraArgs&#34;, &#34;value&#34;: {&#34;node-labels&#34;: &#34;openebs.io/engine=mayastor&#34;}}]&#39;</span>
</span></span></code></pre></div><blockquote>
<p>Note: If you are adding/updating the <code>vm.nr_hugepages</code> on a node which already had the <code>openebs.io/engine=mayastor</code> label set, you&rsquo;d need to restart kubelet so that it picks up the new value, by issuing the following command</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>talosctl -n &lt;node ip&gt; service kubelet restart
</span></span></code></pre></div><h3 id="deploy-mayastor">Deploy Mayastor</h3>
<p>Continue setting up <a href="https://mayastor.gitbook.io/introduction/quickstart/deploy-mayastor">Mayastor</a> using the official documentation.</p>
<h2 id="nfs">NFS</h2>
<p>NFS is an old pack animal long past its prime.
However, it is supported by a wide variety of systems.
You don&rsquo;t want to use it unless you have to, but unfortunately, that &ldquo;have to&rdquo; is too frequent.</p>
<p>NFS is slow, has all kinds of bottlenecks involving contention, distributed locking, single points of service, and more.</p>
<p>The NFS client is part of the <a href="https://github.com/talos-systems/kubelet"><code>kubelet</code> image</a> maintained by the Talos team.
This means that the version installed in your running <code>kubelet</code> is the version of NFS supported by Talos.
You can reduce some of the contention problems by parceling Persistent Volumes from separate underlying directories.</p>
<h2 id="object-storage">Object storage</h2>
<p>Ceph comes with an S3-compatible object store, but there are other options, as
well.
These can often be built on top of other storage backends.
For instance, you may have your block storage running with Mayastor but assign a
Pod a large Persistent Volume to serve your object store.</p>
<p>One of the most popular open source add-on object stores is <a href="https://min.io/">MinIO</a>.</p>
<h2 id="others-iscsi">Others (iSCSI)</h2>
<p>The most common remaining systems involve iSCSI in one form or another.
This includes things like the original OpenEBS, Rancher&rsquo;s Longhorn, and many proprietary systems.
Unfortunately, Talos does <em>not</em> support iSCSI-based systems.
iSCSI in Linux is facilitated by <a href="https://github.com/open-iscsi/open-iscsi">open-iscsi</a>.
This system was designed long before containers caught on, and it is not well
suited to the task, especially when coupled with a read-only host operating
system.</p>
<p>One day, we hope to work out a solution for facilitating iSCSI-based systems, but this is not yet available.</p>

      </div>
    </div>
  </div>
</section>


      
<section class="section">
  <div class="container">
    <nav class="pagination" role="navigation" aria-label="pagination">
      
      <a class="pagination-previous has-text-white has-background-primary" href="/docs/v0.14/guides/rbac/">
        <span class="icon">
          <ion-icon name="arrow-back-outline"></ion-icon>
        </span>
        <span>
          Role-based access control (RBAC)
        </span>
      </a>
      

      
      <a class="pagination-next has-text-white has-background-primary" href="/docs/v0.14/guides/troubleshooting-control-plane/">
        <span>
          Troubleshooting Control Plane
        </span>

        <span class="icon">
          <ion-icon name="arrow-forward-outline"></ion-icon>
        </span>
      </a>
      
    </nav>
  </div>
</section>


      






<section class="hero">
  <div class="hero-body">
    <div class="container">
      <hr />

      <p class="has-text-weight-light">
        &copy; 2019-2022 Longhorn Authors | Documentation Distributed under CC-BY-4.0
      </p>

      <br />

      <p class="has-text-weight-light">
        &copy; 2022 The Linux Foundation. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our <a href="https://www.linuxfoundation.org/trademark-usage/" target="_blank">Trademark Usage</a> page.
      </p>
    </div>
  </div>
</section>

    </div>
    
  </div>

  
<div class="drawer" :class="{ 'is-visible': drawer }">
  


<aside class="nav is-drawer">
  
  <span class="icon is-hoverable" @click="drawer = !drawer">
    <ion-icon size="large" name="close-circle-outline"></ion-icon>
  </span>
  

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
   
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.14/">
      Welcome
    </a>

    
  </div>

  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.14/introduction/">
      Introduction
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/introduction/what-is-talos/">
          What is Talos?
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/introduction/quickstart/">
          Quickstart
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/introduction/getting-started/">
          Getting Started
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/introduction/system-requirements/">
          System Requirements
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/introduction/what-is-new/">
          What&#39;s New in Talos 0.14
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/introduction/support-matrix/">
          Support Matrix
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.14/bare-metal-platforms/">
      Bare Metal Platforms
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/bare-metal-platforms/digital-rebar/">
          Digital Rebar
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/bare-metal-platforms/equinix-metal/">
          Equinix Metal
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/bare-metal-platforms/matchbox/">
          Matchbox
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/bare-metal-platforms/sidero/">
          Sidero
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.14/virtualized-platforms/">
      Virtualized Platforms
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/virtualized-platforms/hyper-v/">
          Hyper-V
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/virtualized-platforms/kvm/">
          KVM
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/virtualized-platforms/proxmox/">
          Proxmox
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/virtualized-platforms/vmware/">
          VMware
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/virtualized-platforms/xen/">
          Xen
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.14/cloud-platforms/">
      Cloud Platforms
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/cloud-platforms/aws/">
          AWS
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/cloud-platforms/azure/">
          Azure
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/cloud-platforms/digitalocean/">
          DigitalOcean
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/cloud-platforms/gcp/">
          GCP
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/cloud-platforms/hetzner/">
          Hetzner
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/cloud-platforms/nocloud/">
          Nocloud
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/cloud-platforms/openstack/">
          Openstack
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/cloud-platforms/scaleway/">
          Scaleway
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/cloud-platforms/upcloud/">
          UpCloud
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/cloud-platforms/vultr/">
          Vultr
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.14/local-platforms/">
      Local Platforms
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/local-platforms/docker/">
          Docker
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/local-platforms/qemu/">
          QEMU
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/local-platforms/virtualbox/">
          VirtualBox
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.14/single-board-computers/">
      Single Board Computers
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/single-board-computers/bananapi_m64/">
          Banana Pi M64
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/single-board-computers/libretech_all_h3_cc_h5/">
          Libre Computer Board ALL-H3-CC
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/single-board-computers/pine64/">
          Pine64
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/single-board-computers/rock64/">
          Pine64 Rock64
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/single-board-computers/rockpi_4/">
          Radxa ROCK PI 4c
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/single-board-computers/rpi_4/">
          Raspberry Pi 4 Model B
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.14/guides/">
      Guides
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/adding-a-proprietary-kernel-module/">
          Adding a proprietary kernel module to Talos Linux
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/advanced-networking/">
          Advanced Networking
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/air-gapped/">
          Air-gapped Environments
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/configuring-certificate-authorities/">
          Configuring Certificate Authorities
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/configuring-containerd/">
          Configuring Containerd
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/configuring-corporate-proxies/">
          Configuring Corporate Proxies
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/configuring-network-connectivity/">
          Configuring Network Connectivity
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/configuring-pull-through-cache/">
          Configuring Pull Through Cache
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/configuring-the-cluster-endpoint/">
          Configuring the Cluster Endpoint
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/configuring-wireguard-network/">
          Configuring Wireguard Network
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/customizing-the-kernel/">
          Customizing the Kernel
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/customizing-the-root-filesystem/">
          Customizing the Root Filesystem
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/deploying-cilium/">
          Deploying Cilium CNI
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/deploy-metrics-server/">
          Deploying Metrics Server
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/disaster-recovery/">
          Disaster Recovery
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/discovery/">
          Discovery
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/disk-encryption/">
          Disk Encryption
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/editing-machine-configuration/">
          Editing Machine Configuration
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/kubespan/">
          KubeSpan
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/logging/">
          Logging
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/managing-pki/">
          Managing PKI
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/resetting-a-machine/">
          Resetting a Machine
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/rbac/">
          Role-based access control (RBAC)
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a class="is-active" href="/docs/v0.14/guides/storage/">
          Storage
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/troubleshooting-control-plane/">
          Troubleshooting Control Plane
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/upgrading-kubernetes/">
          Upgrading Kubernetes
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/upgrading-talos/">
          Upgrading Talos
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/guides/vip/">
          Virtual (shared) IP
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.14/reference/">
      Reference
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/reference/kernel/">
          Kernel
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/reference/platform/">
          Platform
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.14/learn-more/">
      Learn More
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/learn-more/philosophy/">
          Philosophy
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/learn-more/concepts/">
          Concepts
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/learn-more/architecture/">
          Architecture
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/learn-more/components/">
          Components
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/learn-more/upgrades/">
          Upgrades
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/learn-more/faqs/">
          FAQs
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/learn-more/talosctl/">
          talosctl
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/learn-more/control-plane/">
          Control Plane
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/learn-more/controllers-resources/">
          Controllers and Resources
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/learn-more/networking-resources/">
          Networking Resources
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/learn-more/discovery/">
          Discovery
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/learn-more/kubespan/">
          KubeSpan
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.14/learn-more/developing-talos/">
          Developing Talos
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
</aside>

</div>

</div>


  
<script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.2.5/dist/alpine.min.js" defer></script>

<script type="module" src="https://unpkg.com/ionicons@5.0.0/dist/ionicons/ionicons.esm.js"></script>
<script nomodule="" src="https://unpkg.com/ionicons@5.0.0/dist/ionicons/ionicons.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.2/anchor.min.js"></script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="/js/jquery.matchHeight.js"></script>
<script src="/js/scripts.js"></script>

<script>
  anchors.options = {
    icon: '#'
  }

  document.addEventListener('DOMContentLoaded', function(event) {
    anchors.add('.content h1, .content h2, .content h3, .content h4, .content h5, .content h6');
  });
</script>


<script>
  const navbarHeight = document.getElementsByClassName('navbar')[0].offsetHeight;
  const extraPadding = 15;
  const navbarOffset = -1 * (navbarHeight + extraPadding);
  var shiftWindow = function() { scrollBy(0, navbarOffset) };
  window.addEventListener("hashchange", shiftWindow);
  window.addEventListener("pageshow", shiftWindow);
  function load() { if (window.location.hash) shiftWindow(); }
</script>



<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script type="text/javascript">
  docsearch({
    apiKey: '3c4082e162be342fa20a794144b4a479',
    indexName: 'longhorn',
    inputSelector: '#search-input',
    algoliaOptions: { 'facetFilters': ["version:v0.14"] },
    debug: false
  });
</script>

  </body>

</html>
