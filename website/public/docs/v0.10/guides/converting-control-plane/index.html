


<!DOCTYPE html>
<html lang="en-us">

<head>
  













<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta name="description" content="How to convert Talos self-hosted Kubernetes control plane (pre-0.9) to static pods based one.">




<link rel="canonical" href="https://talos.dev/docs/latest/guides/converting-control-plane/">



<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://talos.dev/img/logos/longhorn-icon-color.png">
<meta name="twitter:image:alt" content="Talos Linux color logo">



<meta property="og:url" content="https://talos.dev/docs/v0.10/guides/converting-control-plane/">
<meta property="og:title" content="Talos Linux | Converting Control Plane">

<meta property="og:description" content="How to convert Talos self-hosted Kubernetes control plane (pre-0.9) to static pods based one.">

<meta property="og:type" content="article">
<meta property="og:site_name" content="Talos Linux">
<meta property="og:image" content="https://talos.dev/img/logos/longhorn-icon-color.png">
<meta property="og:image:type" content="image/png">
<meta property="og:image:alt" content="Talos Linux color logo">
<meta property="og:locale" content="en_US">


<meta name="robots" content="noindex">



  <title>
    
Talos Linux | Documentation

  </title>

  









<link rel="stylesheet" href="/css/style.d4f1ecd1424891e50994bf3612432659314faa7af1abc56b06aca280b90673fb.css" integrity="sha256-1PHs0UJIkeUJlL82EkMmWTFPqnrxq8VrBqyigLkGc/s=">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />

  <link rel="shortcut icon" type="image/png" sizes="32x32" href="/favicon.png">

</head>
<body>
  





<div class="canvas" id="canvas" x-data="{ drawer: false }">
  







<nav class="navbar is-fixed-top has-shadow" x-data="{ open: false }">
  
    <div class="navbar-brand">
      <a class="navbar-item" href="https://talos.dev">
        <img src="/img/logos/Sidero_horizontal_lightbkgd_RGB.png" alt="Talos Linux navbar logo">
      </a>

      <a role="button" class="navbar-burger" data-target="menu" aria-label="menu" aria-expanded="false" :class="{ 'is-active': open }" @click="open = !open" @click.away="open = false">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>

    <div class="navbar-menu" id="menu" :class="{ 'is-active': open }">
      <div class="navbar-end">
        <div class="navbar-item is-hidden-touch">
  <p class="control has-icons-left">
    <input class="input is-rounded" type="text" placeholder="Search" id="search-input">
    <span class="icon is-small is-left">
      <ion-icon name="search-outline"></ion-icon>
    </span>
  </p>
</div>


        


<nav class="navbar" role="navigation" aria-label="dropdown navigation">
  <div class="navbar-item has-dropdown is-hoverable">
    <a class="navbar-link is-arrowless" href="/docs/v1.0">
      <span class="has-text-weight-bold">
        Docs
      </span>
      <span class="icon has-text-secondary">
        <ion-icon name="chevron-down-outline"></ion-icon>
      </span>
    </a>

    <div class="navbar-dropdown">
      
      
      
      <a class="navbar-item" href="/docs/v1.0">
        v1.0 (<strong>latest</strong>)
      </a>
      
      
      
      <a class="navbar-item" href="/docs/v0.14">
        v0.14
      </a>
      
      
      
      <a class="navbar-item" href="/docs/v0.13">
        v0.13
      </a>
      
      
      
      <a class="navbar-item" href="/docs/v0.12">
        v0.12
      </a>
      
      
      
      <a class="navbar-item" href="/docs/v0.11">
        v0.11
      </a>
      
      
      
      <a class="navbar-item" href="/docs/v0.10">
        v0.10
      </a>
      
      
      
      <a class="navbar-item" href="/docs/v0.9">
        v0.9
      </a>
      
      
      
      <a class="navbar-item" href="/docs/v0.8">
        v0.8
      </a>
      
      
      
      <a class="navbar-item" href="/docs/v0.7">
        v0.7
      </a>
      
      
      
      <a class="navbar-item" href="/docs/v0.6">
        v0.6
      </a>
      
    </div>
  </div>
</nav>


        
        




<a class="navbar-item has-text-weight-bold" href="https://sidero.dev"  target="_blank" >
  <span>
    Sidero Metal
  </span>
</a>





<a class="navbar-item has-text-weight-bold" href="https://github.com/talos-systems/talos"  target="_blank" >
  <span>
    GitHub
  </span>
</a>





<a class="navbar-item has-text-weight-bold" href="https://taloscommunity.slack.com"  target="_blank" >
  <span>
    Slack
  </span>
</a>



        

        <div class="navbar-item">
          



<div class="buttons is-left">
  

  

  
</div>

        </div>
      </div>
    </div>
  
</nav>

  

<nav class="navbar is-black is-hidden-desktop under-nav">
  <div class="navbar-brand">
    <div class="navbar-item is-hidden-desktop">
      <a class="button is-black is-borderless has-text-weight-light" @click="drawer = !drawer">
        <span class="icon">
          <ion-icon name="list"></ion-icon>
        </span>
        <span>
          Docs
        </span>
      </a>
    </div>
  </div>
</nav>


  <div class="dashboard">
    
    <div class="dashboard-panel sidebar is-hidden-touch">
      


<aside class="nav is-sidebar">
  

  
  
  
   
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.10/">
      Welcome
    </a>

    
  </div>

  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.10/introduction/">
      Introduction
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/introduction/what-is-talos/">
          What is Talos?
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/introduction/quickstart/">
          Quickstart
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/introduction/getting-started/">
          Getting Started
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/introduction/system-requirements/">
          System Requirements
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/introduction/what-is-new/">
          What&#39;s New in Talos 0.10
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.10/bare-metal-platforms/">
      Bare Metal Platforms
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/bare-metal-platforms/digital-rebar/">
          Digital Rebar
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/bare-metal-platforms/equinix-metal/">
          Equinix Metal
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/bare-metal-platforms/matchbox/">
          Matchbox
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/bare-metal-platforms/sidero/">
          Sidero
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.10/virtualized-platforms/">
      Virtualized Platforms
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/virtualized-platforms/hyper-v/">
          Hyper-V
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/virtualized-platforms/kvm/">
          KVM
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/virtualized-platforms/proxmox/">
          Proxmox
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/virtualized-platforms/vmware/">
          VMware
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/virtualized-platforms/xen/">
          Xen
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.10/cloud-platforms/">
      Cloud Platforms
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/cloud-platforms/aws/">
          AWS
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/cloud-platforms/azure/">
          Azure
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/cloud-platforms/digitalocean/">
          DigitalOcean
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/cloud-platforms/gcp/">
          GCP
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/cloud-platforms/openstack/">
          Openstack
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.10/local-platforms/">
      Local Platforms
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/local-platforms/docker/">
          Docker
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/local-platforms/firecracker/">
          Firecracker
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/local-platforms/qemu/">
          QEMU
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/local-platforms/virtualbox/">
          VirtualBox
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.10/single-board-computers/">
      Single Board Computers
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/single-board-computers/bananapi_m64/">
          Banana Pi M64
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/single-board-computers/libretech_all_h3_cc_h5/">
          Libre Computer Board ALL-H3-CC
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/single-board-computers/rock64/">
          Pine64 Rock64
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/single-board-computers/rockpi_4/">
          Radxa ROCK PI 4c
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/single-board-computers/rpi_4/">
          Raspberry Pi 4 Model B
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.10/guides/">
      Guides
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/advanced-networking/">
          Advanced Networking
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/air-gapped/">
          Air-gapped Environments
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/configuring-certificate-authorities/">
          Configuring Certificate Authorities
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/configuring-containerd/">
          Configuring Containerd
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/configuring-corporate-proxies/">
          Configuring Corporate Proxies
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/configuring-network-connectivity/">
          Configuring Network Connectivity
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/configuring-pull-through-cache/">
          Configuring Pull Through Cache
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/configuring-the-cluster-endpoint/">
          Configuring the Cluster Endpoint
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/configuring-wireguard-network/">
          Configuring Wireguard Network
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a class="is-active" href="/docs/v0.10/guides/converting-control-plane/">
          Converting Control Plane
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/customizing-the-kernel/">
          Customizing the Kernel
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/customizing-the-root-filesystem/">
          Customizing the Root Filesystem
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/deploy-metrics-server/">
          Deploying Metrics Server
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/disaster-recovery/">
          Disaster Recovery
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/disk-encryption/">
          Disk Encryption
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/editing-machine-configuration/">
          Editing Machine Configuration
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/managing-pki/">
          Managing PKI
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/resetting-a-machine/">
          Resetting a Machine
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/storage/">
          Storage
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/troubleshooting-control-plane/">
          Troubleshooting Control Plane
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/upgrading-kubernetes/">
          Upgrading Kubernetes
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/upgrading-talos/">
          Upgrading Talos
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/vip/">
          Virtual (shared) IP
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.10/reference/">
      Reference
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/reference/kernel/">
          Kernel
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/reference/platform/">
          Platform
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.10/learn-more/">
      Learn More
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/learn-more/philosophy/">
          Philosophy
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/learn-more/concepts/">
          Concepts
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/learn-more/architecture/">
          Architecture
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/learn-more/components/">
          Components
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/learn-more/upgrades/">
          Upgrades
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/learn-more/faqs/">
          FAQs
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/learn-more/talosctl/">
          talosctl
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/learn-more/control-plane/">
          Control Plane
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/learn-more/controllers-resources/">
          Controllers and Resources
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
</aside>

    </div>

    <div class="dashboard-panel main">
      



<section class="hero is-primary is-medium is-bold">
  <div class="hero-body">
    <div class="container">
      <div class="docs-content">
        <p class="title is-size-2 is-size-3-mobile has-text-weight-bold is-spaced">
          Converting Control Plane
        </p>

        
        <p class="subtitle is-size-3 is-size-4-mobile has-text-weight-light">
          How to convert Talos self-hosted Kubernetes control plane (pre-0.9) to static pods based one.
        </p>
        
      </div>
      <div class="buttons">
        <a class="button is-small" href="https://github.com/longhorn/website/edit/master/content/docs/v0.10/Guides/converting-control-plane.md" target="_blank">
          <span class="icon">
            <ion-icon name="logo-github"></ion-icon>
          </span>
          <span>
            Edit this page
          </span>
        </a>
      </div>
    </div>
  </div>
</section>

      
<section class="section">
  <div class="container">
    <div class="docs-content">
      <div class="content has-extra-bottom-padding">
        <p>Talos version 0.9 runs Kubernetes control plane in a new way: static pods managed by Talos.
Talos version 0.8 and below runs self-hosted control plane.
After Talos OS upgrade to version 0.9 Kubernetes control plane should be converted to run as static pods.</p>
<p>This guide describes automated conversion script and also shows detailed manual conversion process.</p>
<h2 id="video-walkthrough">Video Walkthrough</h2>
<p>To see a live demo of this writeup, see the video below:</p>
<!-- raw HTML omitted -->
<h2 id="automated-conversion">Automated Conversion</h2>
<p>First, make sure all nodes are updated to Talos 0.9:</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ kubectl get nodes -o wide
</span></span><span style="display:flex;"><span>NAME                     STATUS   ROLES                  AGE   VERSION   INTERNAL-IP   EXTERNAL-IP   OS-IMAGE         KERNEL-VERSION   CONTAINER-RUNTIME
</span></span><span style="display:flex;"><span>talos-default-master-1   Ready    control-plane,master   58m   v1.20.4   172.20.0.2    &lt;none&gt;        Talos <span style="color:#719e07">(</span>v0.9.0<span style="color:#719e07">)</span>   5.10.19-talos    containerd://1.4.4
</span></span><span style="display:flex;"><span>talos-default-master-2   Ready    control-plane,master   58m   v1.20.4   172.20.0.3    &lt;none&gt;        Talos <span style="color:#719e07">(</span>v0.9.0<span style="color:#719e07">)</span>   5.10.19-talos    containerd://1.4.4
</span></span><span style="display:flex;"><span>talos-default-master-3   Ready    control-plane,master   58m   v1.20.4   172.20.0.4    &lt;none&gt;        Talos <span style="color:#719e07">(</span>v0.9.0<span style="color:#719e07">)</span>   5.10.19-talos    containerd://1.4.4
</span></span><span style="display:flex;"><span>talos-default-worker-1   Ready    &lt;none&gt;                 58m   v1.20.4   172.20.0.5    &lt;none&gt;        Talos <span style="color:#719e07">(</span>v0.9.0<span style="color:#719e07">)</span>   5.10.19-talos    containerd://1.4.4
</span></span></code></pre></div><p>Start the conversion script:</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ talosctl -n &lt;IP&gt; convert-k8s
</span></span><span style="display:flex;"><span>discovered master nodes <span style="color:#719e07">[</span><span style="color:#2aa198">&#34;172.20.0.2&#34;</span> <span style="color:#2aa198">&#34;172.20.0.3&#34;</span> <span style="color:#2aa198">&#34;172.20.0.4&#34;</span><span style="color:#719e07">]</span>
</span></span><span style="display:flex;"><span>current self-hosted status: <span style="color:#b58900">true</span>
</span></span><span style="display:flex;"><span>gathering control plane configuration
</span></span><span style="display:flex;"><span>aggregator CA key can<span style="color:#2aa198">&#39;t be recovered from bootkube-boostrapped control plane, generating new CA
</span></span></span><span style="display:flex;"><span><span style="color:#2aa198">patching master node &#34;172.20.0.2&#34; configuration
</span></span></span><span style="display:flex;"><span><span style="color:#2aa198">patching master node &#34;172.20.0.3&#34; configuration
</span></span></span><span style="display:flex;"><span><span style="color:#2aa198">patching master node &#34;172.20.0.4&#34; configuration
</span></span></span><span style="display:flex;"><span><span style="color:#2aa198">waiting for static pod definitions to be generated
</span></span></span><span style="display:flex;"><span><span style="color:#2aa198">waiting for manifests to be generated
</span></span></span><span style="display:flex;"><span><span style="color:#2aa198">Talos generated control plane static pod definitions and bootstrap manifests, please verify them with commands:
</span></span></span><span style="display:flex;"><span><span style="color:#2aa198">    talosctl -n &lt;master node IP&gt; get StaticPods.kubernetes.talos.dev
</span></span></span><span style="display:flex;"><span><span style="color:#2aa198">    talosctl -n &lt;master node IP&gt; get Manifests.kubernetes.talos.dev
</span></span></span><span style="display:flex;"><span><span style="color:#2aa198">
</span></span></span><span style="display:flex;"><span><span style="color:#2aa198">in order to remove self-hosted control plane, pod-checkpointer component needs to be disabled
</span></span></span><span style="display:flex;"><span><span style="color:#2aa198">once pod-checkpointer is disabled, the cluster shouldn&#39;</span>t be rebooted <span style="color:#719e07">until</span> the entire conversion process is <span style="color:#b58900">complete</span>
</span></span><span style="display:flex;"><span>confirm disabling pod-checkpointer to proceed with control plane update <span style="color:#719e07">[</span>yes/no<span style="color:#719e07">]</span>:
</span></span></code></pre></div><p>Script stops at this point waiting for confirmation.
Talos still runs self-hosted control plane, and static pods were not rendered yet.</p>
<p>As instructed by the script, please verify that static pod definitions are correct:</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ talosctl -n &lt;IP&gt; get staticpods -o yaml
</span></span><span style="display:flex;"><span>node: 172.20.0.2
</span></span><span style="display:flex;"><span>metadata:
</span></span><span style="display:flex;"><span>    namespace: controlplane
</span></span><span style="display:flex;"><span>    type: StaticPods.kubernetes.talos.dev
</span></span><span style="display:flex;"><span>    id: kube-apiserver
</span></span><span style="display:flex;"><span>    version: <span style="color:#2aa198">1</span>
</span></span><span style="display:flex;"><span>    phase: running
</span></span><span style="display:flex;"><span>spec:
</span></span><span style="display:flex;"><span>    apiVersion: v1
</span></span><span style="display:flex;"><span>    kind: Pod
</span></span><span style="display:flex;"><span>    metadata:
</span></span><span style="display:flex;"><span>        annotations:
</span></span><span style="display:flex;"><span>            talos.dev/config-version: <span style="color:#2aa198">&#34;2&#34;</span>
</span></span><span style="display:flex;"><span>            talos.dev/secrets-version: <span style="color:#2aa198">&#34;1&#34;</span>
</span></span><span style="display:flex;"><span>        creationTimestamp: null
</span></span><span style="display:flex;"><span>        labels:
</span></span><span style="display:flex;"><span>            k8s-app: kube-apiserver
</span></span><span style="display:flex;"><span>            tier: control-plane
</span></span><span style="display:flex;"><span>        name: kube-apiserver
</span></span><span style="display:flex;"><span>        namespace: kube-system
</span></span><span style="display:flex;"><span>    spec:
</span></span><span style="display:flex;"><span>        containers:
</span></span><span style="display:flex;"><span>            - command:
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><p>Static pod definitions are generated from the machine configuration and should match pod template as generated by Talos on bootstrap of self-hosted control plane unless there were some manual changes applied to the daemonset specs after bootstrap.
Talos patches the machine configuration with the container image versions scraped from the daemonset definition, fetches the service account key from Kubernetes secrets.</p>
<p>Aggregator CA can&rsquo;t be recovered from the self-hosted control plane, so new CA gets generated.
This is generally harmless and not visible from outside the cluster.
The Aggregator CA is <em>not</em> the same CA as is used by Talos or Kubernetes standard API.
It is a special PKI used for aggregating API extension services inside your cluster.
If you have non-standard apiserver aggregations (fairly rare, and you should know if you do), then you may need to restart these services after the new CA is in place.</p>
<p>Verify that bootstrap manifests are correct:</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ talosctl -n &lt;IP&gt; get manifests
</span></span><span style="display:flex;"><span>NODE         NAMESPACE      TYPE       ID                               VERSION
</span></span><span style="display:flex;"><span>172.20.0.2   controlplane   Manifest   00-kubelet-bootstrapping-token   <span style="color:#2aa198">1</span>
</span></span><span style="display:flex;"><span>172.20.0.2   controlplane   Manifest   01-csr-approver-role-binding     <span style="color:#2aa198">1</span>
</span></span><span style="display:flex;"><span>172.20.0.2   controlplane   Manifest   01-csr-node-bootstrap            <span style="color:#2aa198">1</span>
</span></span><span style="display:flex;"><span>172.20.0.2   controlplane   Manifest   01-csr-renewal-role-binding      <span style="color:#2aa198">1</span>
</span></span><span style="display:flex;"><span>172.20.0.2   controlplane   Manifest   02-kube-system-sa-role-binding   <span style="color:#2aa198">1</span>
</span></span><span style="display:flex;"><span>172.20.0.2   controlplane   Manifest   03-default-pod-security-policy   <span style="color:#2aa198">1</span>
</span></span><span style="display:flex;"><span>172.20.0.2   controlplane   Manifest   05-https://docs.projectcalico.org/manifests/calico.yaml   <span style="color:#2aa198">1</span>
</span></span><span style="display:flex;"><span>172.20.0.2   controlplane   Manifest   10-kube-proxy                    <span style="color:#2aa198">1</span>
</span></span><span style="display:flex;"><span>172.20.0.2   controlplane   Manifest   11-core-dns                      <span style="color:#2aa198">1</span>
</span></span><span style="display:flex;"><span>172.20.0.2   controlplane   Manifest   11-core-dns-svc                  <span style="color:#2aa198">1</span>
</span></span><span style="display:flex;"><span>172.20.0.2   controlplane   Manifest   11-kube-config-in-cluster        <span style="color:#2aa198">1</span>
</span></span></code></pre></div><p>Make sure that manifests and static pods are correct across all control plane nodes, as each node reconciles
control plane state on its own.
For example, CNI configuration in machine config should be in sync across all the nodes.
Talos nodes try to create any missing Kubernetes resources from the manifests, but it never
updates or deletes existing resources.</p>
<p>If something looks wrong, script can be aborted and machine configuration should be updated to fix the problem.
Once configuration is updated, the script can be restarted.</p>
<p>If static pod definitions and manifests look good, confirm next step to disable <code>pod-checkpointer</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ talosctl -n &lt;IP&gt; convert-k8s
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>confirm disabling pod-checkpointer to proceed with control plane update <span style="color:#719e07">[</span>yes/no<span style="color:#719e07">]</span>: yes
</span></span><span style="display:flex;"><span>disabling pod-checkpointer
</span></span><span style="display:flex;"><span>deleting daemonset <span style="color:#2aa198">&#34;pod-checkpointer&#34;</span>
</span></span><span style="display:flex;"><span>checking <span style="color:#719e07">for</span> active pod checkpoints
</span></span><span style="display:flex;"><span>2021/03/09 23:37:25 retrying error: found <span style="color:#2aa198">3</span> active pod checkpoints: <span style="color:#719e07">[</span>pod-checkpointer-655gc-talos-default-master-3 pod-checkpointer-pw6mv-talos-default-master-1 pod-checkpointer-zdw9z-talos-default-master-2<span style="color:#719e07">]</span>
</span></span><span style="display:flex;"><span>2021/03/09 23:42:25 retrying error: found <span style="color:#2aa198">1</span> active pod checkpoints: <span style="color:#719e07">[</span>pod-checkpointer-pw6mv-talos-default-master-1<span style="color:#719e07">]</span>
</span></span><span style="display:flex;"><span>confirm applying static pod definitions and manifests <span style="color:#719e07">[</span>yes/no<span style="color:#719e07">]</span>:
</span></span></code></pre></div><p>Self-hosted control plane runs <code>pod-checkpointer</code> to work around issues with control plane availability.
It should be disabled before conversion starts to allow self-hosted control plane to be removed.
It takes around 5 minutes for the <code>pod-checkpointer</code> to be fully disabled.
Script verifies that all checkpoints are removed before proceeding.</p>
<p>This last confirmation before proceeding is at the point when there is no way to keep running self-hosted control plane:
static pods are released, bootstrap manifests are applied, self-hosted control plane is removed.</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ talosctl -n &lt;IP&gt; convert-k8s
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>confirm applying static pod definitions and manifests <span style="color:#719e07">[</span>yes/no<span style="color:#719e07">]</span>: yes
</span></span><span style="display:flex;"><span>removing self-hosted initialized key
</span></span><span style="display:flex;"><span>waiting <span style="color:#719e07">for</span> static pods <span style="color:#719e07">for</span> <span style="color:#2aa198">&#34;kube-apiserver&#34;</span> to be present in the API server state
</span></span><span style="display:flex;"><span>waiting <span style="color:#719e07">for</span> static pods <span style="color:#719e07">for</span> <span style="color:#2aa198">&#34;kube-controller-manager&#34;</span> to be present in the API server state
</span></span><span style="display:flex;"><span>waiting <span style="color:#719e07">for</span> static pods <span style="color:#719e07">for</span> <span style="color:#2aa198">&#34;kube-scheduler&#34;</span> to be present in the API server state
</span></span><span style="display:flex;"><span>deleting daemonset <span style="color:#2aa198">&#34;kube-apiserver&#34;</span>
</span></span><span style="display:flex;"><span>waiting <span style="color:#719e07">for</span> static pods <span style="color:#719e07">for</span> <span style="color:#2aa198">&#34;kube-apiserver&#34;</span> to be present in the API server state
</span></span><span style="display:flex;"><span>deleting daemonset <span style="color:#2aa198">&#34;kube-controller-manager&#34;</span>
</span></span><span style="display:flex;"><span>waiting <span style="color:#719e07">for</span> static pods <span style="color:#719e07">for</span> <span style="color:#2aa198">&#34;kube-controller-manager&#34;</span> to be present in the API server state
</span></span><span style="display:flex;"><span>deleting daemonset <span style="color:#2aa198">&#34;kube-scheduler&#34;</span>
</span></span><span style="display:flex;"><span>waiting <span style="color:#719e07">for</span> static pods <span style="color:#719e07">for</span> <span style="color:#2aa198">&#34;kube-scheduler&#34;</span> to be present in the API server state
</span></span><span style="display:flex;"><span>conversion process completed successfully
</span></span></code></pre></div><p>As soon as the control plane static pods are rendered, the kubelet starts the control plane static pods.
It is expected that the pods for <code>kube-apiserver</code> will crash initially.
Only one <code>kube-apiserver</code> can be bound to the host <code>Node</code>&rsquo;s port 6443 at a time.
Eventually, the old <code>kube-apiserver</code> will be killed, and the new one will be able to start.
This is all handled automatically.
The script will continue by removing each self-hosted daemonset and verifying that static pods are ready and healthy.</p>
<h2 id="manual-conversion">Manual Conversion</h2>
<p>Check that Talos runs self-hosted control plane:</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ talosctl -n &lt;CONTROL_PLANE_IP&gt; get bs
</span></span><span style="display:flex;"><span>NODE         NAMESPACE   TYPE              ID              VERSION   SELF HOSTED
</span></span><span style="display:flex;"><span>172.20.0.2   runtime     BootstrapStatus   control-plane   <span style="color:#2aa198">2</span>         <span style="color:#b58900">true</span>
</span></span></code></pre></div><p>Talos machine configuration need to be updated to the 0.9 format; there are two new required machine configuration settings:</p>
<ul>
<li><code>.cluster.serviceAccount</code> is the service account PEM-encoded private key.</li>
<li><code>.cluster.aggregatorCA</code> is the aggregator CA for <code>kube-apiserver</code> (certficiate and private key).</li>
</ul>
<p>Current service account can be fetched from the Kubernetes secrets:</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ kubectl -n kube-system get secrets kube-controller-manager -o <span style="color:#268bd2">jsonpath</span><span style="color:#719e07">=</span><span style="color:#2aa198">&#39;{.data.service\-account\.key}&#39;</span>
</span></span><span style="display:flex;"><span>LS0tLS1CRUdJTiBSU0EgUFJJVkFURS...
</span></span></code></pre></div><p>All control plane node machine configurations should be patched with the service account key:</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ talosctl -n &lt;CONTROL_PLANE_IP1&gt;,&lt;CONTROL_PLANE_IP2&gt;,... patch mc --immediate -p <span style="color:#2aa198">&#39;[{&#34;op&#34;: &#34;add&#34;, &#34;path&#34;: &#34;/cluster/serviceAccount&#34;, &#34;value&#34;: {&#34;key&#34;: &#34;LS0tLS1CRUdJTiBSU0EgUFJJVkFURS...&#34;}}]&#39;</span>
</span></span><span style="display:flex;"><span>patched mc at the node 172.20.0.2
</span></span></code></pre></div><p>Aggregator CA can be generated using OpenSSL or any other certificate generation tools: RSA or ECDSA certificate with CN <code>front-proxy</code> valid for 10 years.
PEM-encoded CA certificate and key should be base64-encoded and patched into the machine config at path <code>/cluster/aggregatorCA</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ talosctl -n &lt;CONTROL_PLANE_IP1&gt;,&lt;CONTROL_PLANE_IP2&gt;,... patch mc --immediate -p <span style="color:#2aa198">&#39;[{&#34;op&#34;: &#34;add&#34;, &#34;path&#34;: &#34;/cluster/aggregatorCA&#34;, &#34;value&#34;: {&#34;crt&#34;: &#34;S0tLS1CRUdJTiBDRVJUSUZJQ...&#34;, &#34;key&#34;: &#34;LS0tLS1CRUdJTiBFQy...&#34;}}]&#39;</span>
</span></span><span style="display:flex;"><span>patched mc at the node 172.20.0.2
</span></span></code></pre></div><p>At this point static pod definitions and bootstrap manifests should be rendered, please see &ldquo;Automated Conversion&rdquo; on how to verify generated objects.
Feel free to continue to refine your machine configuration until the generated static pod definitions and bootstrap manifests look good.</p>
<p>If static pod definitions are not generated, check logs with <code>talosctl -n &lt;IP&gt; logs controller-runtime</code>.</p>
<p>Disable <code>pod-checkpointer</code> with:</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ kubectl -n kube-system delete ds pod-checkpointer
</span></span><span style="display:flex;"><span>daemonset.apps <span style="color:#2aa198">&#34;pod-checkpointer&#34;</span> deleted
</span></span></code></pre></div><p>Wait for all pod checkpoints to be removed:</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ kubectl -n kube-system get pods
</span></span><span style="display:flex;"><span>NAME                                            READY   STATUS    RESTARTS   AGE
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>pod-checkpointer-8q2lh-talos-default-master-2   1/1     Running   <span style="color:#2aa198">0</span>          3m34s
</span></span><span style="display:flex;"><span>pod-checkpointer-nnm5w-talos-default-master-3   1/1     Running   <span style="color:#2aa198">0</span>          3m24s
</span></span><span style="display:flex;"><span>pod-checkpointer-qnmdt-talos-default-master-1   1/1     Running   <span style="color:#2aa198">0</span>          2m21s
</span></span></code></pre></div><p>Pod checkpoints have annotation <code>checkpointer.alpha.coreos.com/checkpoint-of</code>.</p>
<p>Once all the pod checkpoints are removed (it takes 5 minutes for the checkpoints to be removed), proceed by removing self-hosted initialized key:</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>talosctl -n &lt;CONTROL_PLANE_IP&gt; convert-k8s --remove-initialized-key
</span></span></code></pre></div><p>Talos controllers will now render static pod definitions, and the kubelet will launch any resulting static pods.</p>
<p>Once static pods are visible in <code>kubectl get pods -n kube-system</code> output, proceed by removing each of the self-hosted daemonsets:</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ kubectl -n kube-system delete daemonset kube-apiserver
</span></span><span style="display:flex;"><span>daemonset.apps <span style="color:#2aa198">&#34;kube-apiserver&#34;</span> deleted
</span></span></code></pre></div><p>Make sure static pods for <code>kube-apiserver</code> got started successfully, pods are running and ready.</p>
<p>Proceed by deleting <code>kube-controller-manager</code> and <code>kube-scheduler</code> daemonsets, verifying that static pods are running between each step:</p>
<div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ kubectl -n kube-system delete daemonset kube-controller-manager
</span></span><span style="display:flex;"><span>daemonset.apps <span style="color:#2aa198">&#34;kube-controller-manager&#34;</span> deleted
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ kubectl -n kube-system delete daemonset kube-scheduler
</span></span><span style="display:flex;"><span>daemonset.apps <span style="color:#2aa198">&#34;kube-scheduler&#34;</span> deleted
</span></span></code></pre></div>
      </div>
    </div>
  </div>
</section>


      
<section class="section">
  <div class="container">
    <nav class="pagination" role="navigation" aria-label="pagination">
      
      <a class="pagination-previous has-text-white has-background-primary" href="/docs/v0.10/guides/configuring-wireguard-network/">
        <span class="icon">
          <ion-icon name="arrow-back-outline"></ion-icon>
        </span>
        <span>
          Configuring Wireguard Network
        </span>
      </a>
      

      
      <a class="pagination-next has-text-white has-background-primary" href="/docs/v0.10/guides/customizing-the-kernel/">
        <span>
          Customizing the Kernel
        </span>

        <span class="icon">
          <ion-icon name="arrow-forward-outline"></ion-icon>
        </span>
      </a>
      
    </nav>
  </div>
</section>


      






<section class="hero">
  <div class="hero-body">
    <div class="container">
      <hr />

      <p class="has-text-weight-light">
        &copy; 2019-2022 Longhorn Authors | Documentation Distributed under CC-BY-4.0
      </p>

      <br />

      <p class="has-text-weight-light">
        &copy; 2022 The Linux Foundation. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our <a href="https://www.linuxfoundation.org/trademark-usage/" target="_blank">Trademark Usage</a> page.
      </p>
    </div>
  </div>
</section>

    </div>
    
  </div>

  
<div class="drawer" :class="{ 'is-visible': drawer }">
  


<aside class="nav is-drawer">
  
  <span class="icon is-hoverable" @click="drawer = !drawer">
    <ion-icon size="large" name="close-circle-outline"></ion-icon>
  </span>
  

  
  
  
   
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.10/">
      Welcome
    </a>

    
  </div>

  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.10/introduction/">
      Introduction
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/introduction/what-is-talos/">
          What is Talos?
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/introduction/quickstart/">
          Quickstart
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/introduction/getting-started/">
          Getting Started
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/introduction/system-requirements/">
          System Requirements
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/introduction/what-is-new/">
          What&#39;s New in Talos 0.10
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.10/bare-metal-platforms/">
      Bare Metal Platforms
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/bare-metal-platforms/digital-rebar/">
          Digital Rebar
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/bare-metal-platforms/equinix-metal/">
          Equinix Metal
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/bare-metal-platforms/matchbox/">
          Matchbox
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/bare-metal-platforms/sidero/">
          Sidero
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.10/virtualized-platforms/">
      Virtualized Platforms
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/virtualized-platforms/hyper-v/">
          Hyper-V
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/virtualized-platforms/kvm/">
          KVM
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/virtualized-platforms/proxmox/">
          Proxmox
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/virtualized-platforms/vmware/">
          VMware
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/virtualized-platforms/xen/">
          Xen
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.10/cloud-platforms/">
      Cloud Platforms
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/cloud-platforms/aws/">
          AWS
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/cloud-platforms/azure/">
          Azure
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/cloud-platforms/digitalocean/">
          DigitalOcean
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/cloud-platforms/gcp/">
          GCP
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/cloud-platforms/openstack/">
          Openstack
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.10/local-platforms/">
      Local Platforms
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/local-platforms/docker/">
          Docker
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/local-platforms/firecracker/">
          Firecracker
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/local-platforms/qemu/">
          QEMU
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/local-platforms/virtualbox/">
          VirtualBox
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.10/single-board-computers/">
      Single Board Computers
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/single-board-computers/bananapi_m64/">
          Banana Pi M64
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/single-board-computers/libretech_all_h3_cc_h5/">
          Libre Computer Board ALL-H3-CC
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/single-board-computers/rock64/">
          Pine64 Rock64
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/single-board-computers/rockpi_4/">
          Radxa ROCK PI 4c
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/single-board-computers/rpi_4/">
          Raspberry Pi 4 Model B
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.10/guides/">
      Guides
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/advanced-networking/">
          Advanced Networking
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/air-gapped/">
          Air-gapped Environments
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/configuring-certificate-authorities/">
          Configuring Certificate Authorities
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/configuring-containerd/">
          Configuring Containerd
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/configuring-corporate-proxies/">
          Configuring Corporate Proxies
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/configuring-network-connectivity/">
          Configuring Network Connectivity
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/configuring-pull-through-cache/">
          Configuring Pull Through Cache
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/configuring-the-cluster-endpoint/">
          Configuring the Cluster Endpoint
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/configuring-wireguard-network/">
          Configuring Wireguard Network
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a class="is-active" href="/docs/v0.10/guides/converting-control-plane/">
          Converting Control Plane
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/customizing-the-kernel/">
          Customizing the Kernel
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/customizing-the-root-filesystem/">
          Customizing the Root Filesystem
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/deploy-metrics-server/">
          Deploying Metrics Server
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/disaster-recovery/">
          Disaster Recovery
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/disk-encryption/">
          Disk Encryption
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/editing-machine-configuration/">
          Editing Machine Configuration
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/managing-pki/">
          Managing PKI
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/resetting-a-machine/">
          Resetting a Machine
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/storage/">
          Storage
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/troubleshooting-control-plane/">
          Troubleshooting Control Plane
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/upgrading-kubernetes/">
          Upgrading Kubernetes
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/upgrading-talos/">
          Upgrading Talos
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/guides/vip/">
          Virtual (shared) IP
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.10/reference/">
      Reference
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/reference/kernel/">
          Kernel
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/reference/platform/">
          Platform
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  <div class="nav-section">
    <a class="nav-section-title" href="/docs/v0.10/learn-more/">
      Learn More
    </a>

    
    <ul class="nav-section-pages">
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/learn-more/philosophy/">
          Philosophy
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/learn-more/concepts/">
          Concepts
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/learn-more/architecture/">
          Architecture
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/learn-more/components/">
          Components
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/learn-more/upgrades/">
          Upgrades
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/learn-more/faqs/">
          FAQs
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/learn-more/talosctl/">
          talosctl
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/learn-more/control-plane/">
          Control Plane
        </a>
      </li>
      
      
      <li class="nav-section-pages-link">
        <a href="/docs/v0.10/learn-more/controllers-resources/">
          Controllers and Resources
        </a>
      </li>
      
    </ul>
    

    
  </div>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
</aside>

</div>

</div>


  
<script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.2.5/dist/alpine.min.js" defer></script>

<script type="module" src="https://unpkg.com/ionicons@5.0.0/dist/ionicons/ionicons.esm.js"></script>
<script nomodule="" src="https://unpkg.com/ionicons@5.0.0/dist/ionicons/ionicons.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.2/anchor.min.js"></script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="/js/jquery.matchHeight.js"></script>
<script src="/js/scripts.js"></script>

<script>
  anchors.options = {
    icon: '#'
  }

  document.addEventListener('DOMContentLoaded', function(event) {
    anchors.add('.content h1, .content h2, .content h3, .content h4, .content h5, .content h6');
  });
</script>


<script>
  const navbarHeight = document.getElementsByClassName('navbar')[0].offsetHeight;
  const extraPadding = 15;
  const navbarOffset = -1 * (navbarHeight + extraPadding);
  var shiftWindow = function() { scrollBy(0, navbarOffset) };
  window.addEventListener("hashchange", shiftWindow);
  window.addEventListener("pageshow", shiftWindow);
  function load() { if (window.location.hash) shiftWindow(); }
</script>



<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script type="text/javascript">
  docsearch({
    apiKey: '3c4082e162be342fa20a794144b4a479',
    indexName: 'longhorn',
    inputSelector: '#search-input',
    algoliaOptions: { 'facetFilters': ["version:v0.10"] },
    debug: false
  });
</script>

  </body>

</html>
